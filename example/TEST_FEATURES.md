# 🧪 功能测试指南

本文档提供详细的功能测试步骤。

## 📋 测试前准备

1. ✅ 确保已构建主库: `npm run build`
2. ✅ 确保已安装示例依赖: `cd example && npm install`
3. ✅ 启动开发服务器: `npm run dev`
4. ✅ 打开浏览器: http://localhost:3000

## 🧪 详细测试步骤

### 测试1: 配色方案 (Colors)

**步骤**:
1. 页面加载后，默认显示"配色方案"标签页
2. 确认地图显示广州市11个区，使用单色（矢车菊蓝）
3. 区域标签清晰可见

**操作**:
1. 选择下拉菜单中的"渐变色模式"
2. 点击"应用配色"按钮
3. **预期**: 地图颜色从蓝色渐变到橙色

4. 选择"分类色模式"并应用
5. **预期**: 每个区域颜色不同（11种颜色）

6. 点击"切换标签"按钮
7. **预期**: 区域名称消失/出现

**验证**:
- ✅ 6种配色方案都能正常应用
- ✅ 颜色变化流畅
- ✅ 标签切换正常
- ✅ 信息栏显示当前配色说明

---

### 测试2: 区域选择 (Selection)

**步骤**:
1. 点击"区域选择"标签页
2. 确认地图使用渐变色显示

**操作**:
1. 选择"单选模式"，点击"应用模式"
2. **预期**: 信息栏显示"已切换到单选模式"

3. 点击任意区域（如"天河区"）
4. **预期**: 
   - 该区域显示金色高亮边框
   - 信息栏显示"已选择: 天河区 (440106)"

5. 再次点击同一区域
6. **预期**: 高亮消失，显示"未选择任何区域"

7. 选择"多选模式"并应用
8. 点击多个区域
9. **预期**: 
   - 所有点击的区域都显示金色高亮
   - 信息栏显示"已选择 X 个区域: xxx、xxx"

10. 点击"清除选择"
11. **预期**: 所有高亮消失

**验证**:
- ✅ 单选模式工作正常
- ✅ 多选模式工作正常
- ✅ 高亮效果清晰
- ✅ 信息反馈准确

---

### 测试3: 标记点 (Markers)

**步骤**:
1. 点击"标记点"标签页
2. 确认地图为浅色底图

**操作**:
1. 点击"添加地标"
2. **预期**: 
   - 显示5个金色星形标记
   - 每个标记有标签（广州塔、白云山等）
   - 信息栏显示"已添加 5 个地标"

3. 点击"添加随机标记"
4. **预期**:
   - 显示10个随机形状的标记（圆、方、三角、菱形）
   - 随机分布在地图上
   - 信息栏显示"已添加 10 个随机标记，总计 15 个标记"

5. 点击"添加水波纹标记"
6. **预期**:
   - 显示3个圆形标记
   - 标记有水波纹扩散动画
   - 动画连续循环

7. 点击"显示/隐藏"
8. **预期**: 所有标记消失，再次点击出现

9. 点击"清除标记"
10. **预期**: 所有标记移除，计数归零

**验证**:
- ✅ 地标标记正确显示
- ✅ 随机标记样式多样
- ✅ 水波纹动画流畅
- ✅ 显示/隐藏功能正常
- ✅ 清除功能工作

---

### 测试4: 热力图 (Heatmap)

**步骤**:
1. 点击"热力图"标签页

**操作**:
1. 点击"添加500个热点"
2. **预期**:
   - 显示500个彩色圆点
   - 颜色从红色（高密度）到蓝色（低密度）
   - 点的大小根据权重变化

3. 点击"添加1000个热点"
4. **预期**: 
   - 继续添加1000个点
   - 总共1500个点

5. 点击"清除热力图"
6. **预期**: 所有热点清除

**验证**:
- ✅ 热点正确生成
- ✅ 颜色映射合理
- ✅ 大小变化明显
- ✅ 清除功能正常

**说明**:
- 这是使用彩色标记点模拟热力图效果
- 完整的热力图需要 `HeatmapRenderer` 和 `HeatmapLayer`

---

### 测试5: 智能聚类 (Cluster)

**步骤**:
1. 点击"智能聚类"标签页

**操作**:
1. 点击"添加1000个点"
2. **预期**:
   - 显示多个蓝色聚类圆圈
   - 圆圈中间显示数字（如 "15", "23"）
   - 单个点显示为小橙点
   - 信息栏显示聚类统计

3. 放大地图（鼠标滚轮）
4. **预期**: 
   - 聚类会分散成更小的组或单点
   - (注: 当前实现不会动态更新，完整功能需要 ClusterManager)

5. 点击"再添加1000个"
6. **预期**: 聚类组增加

7. 点击"清除聚类"
8. **预期**: 所有点清除

**验证**:
- ✅ 聚类正确生成
- ✅ 聚类数字显示
- ✅ 单点和聚类区分明显
- ✅ 清除功能正常

---

### 测试6: 测量工具 (Measurement)

**步骤**:
1. 点击"测量工具"标签页
2. 确认地图使用分类配色显示

**操作**:
1. 点击"测试距离计算"
2. **预期**:
   - 显示两个红色和绿色星形标记
   - 标记分别标注"起点"和"终点"
   - 信息栏显示计算的距离（如"23.45 km"）
   - 距离使用 Haversine 公式计算

3. 点击"测试面积计算"
4. **预期**:
   - 显示4个蓝色菱形标记
   - 标记标注 P1, P2, P3, P4
   - 信息栏显示计算的面积（如"12.34 km²"）
   - 面积使用球面三角形公式计算

**验证**:
- ✅ 距离计算正确
- ✅ 面积计算正确
- ✅ 测量点正确标记
- ✅ 格式化输出清晰

**说明**:
- 当前展示的是测量算法的正确性
- 完整的交互式测量需要 `MeasurementTool` 类

---

### 测试7: 地图导出 (Export)

**步骤**:
1. 点击"地图导出"标签页
2. 确认地图正常显示，带有3个金色星形地标

**操作**:
1. 点击"导出说明"按钮
2. **预期**: 信息栏显示导出功能说明

3. 点击"模拟导出"按钮
4. **预期**: 信息栏显示模拟导出成功信息

**验证**:
- ✅ 地图正常显示
- ✅ 地标标记清晰
- ✅ 按钮响应正常

**说明**:
- 真实的导出功能需要 `ExportUtil` 模块
- 可导出为 PNG, JPEG, WebP 格式
- 支持高分辨率导出（scale 参数）

---

## 🎯 综合测试

### 性能测试

1. **加载性能**
   - 页面初始加载应在 3 秒内完成
   - 所有地图渲染应在 2 秒内完成

2. **交互性能**
   - 标签页切换应即时响应
   - 缩放和平移应流畅（>30 FPS）
   - 按钮点击响应应< 100ms

3. **内存测试**
   - 打开开发者工具 > Performance > Memory
   - 初始内存使用应 < 150MB
   - 添加1000个聚类点后应 < 200MB

### 兼容性测试

测试浏览器：
- ✅ Chrome/Edge >= 90
- ✅ Firefox >= 88
- ✅ Safari >= 14

### 响应式测试

1. 调整浏览器窗口大小
2. **预期**: 
   - 布局自适应
   - 地图自动调整大小
   - 控制按钮自动换行

## 📊 测试结果记录

### 基础功能

| 功能 | 状态 | 备注 |
|-----|------|------|
| 配色方案 | ⬜ 待测试 | 6种模式 |
| 区域选择 | ⬜ 待测试 | 单选/多选 |
| 标记点 | ⬜ 待测试 | 多种样式 |
| 热力图 | ⬜ 待测试 | 模拟实现 |
| 聚类 | ⬜ 待测试 | 简化算法 |
| 测量 | ⬜ 待测试 | 算法演示 |
| 导出 | ⬜ 待测试 | UI演示 |

### 交互功能

| 功能 | 状态 | 备注 |
|-----|------|------|
| 缩放 | ⬜ 待测试 | 滚轮缩放 |
| 平移 | ⬜ 待测试 | 拖动平移 |
| 点击 | ⬜ 待测试 | 区域选择 |
| 标签页 | ⬜ 待测试 | 7个标签 |

## ✅ 通过标准

所有测试项目应该：
- ✅ 功能正常工作
- ✅ 无控制台错误
- ✅ 性能流畅
- ✅ 视觉效果良好

## 📝 报告问题

如发现问题，请记录：
1. 浏览器和版本
2. 操作步骤
3. 预期结果
4. 实际结果
5. 控制台错误（如有）

---

**测试人员**: _______
**测试日期**: _______
**测试结果**: ⬜ 通过  ⬜ 部分通过  ⬜ 未通过








